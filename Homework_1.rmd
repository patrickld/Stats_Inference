## Exercise 3 - Algorithm for simulation

(a) What is the distribution of $F^{−1}(U)$, where $F^{−1}$ is the inverse function of $F$?

Let $F$ be a continuous cumulative distribution function. For any continuous and non-decreasing function $F$ on $ℝ$, the generalized inverse of F is defined by:

$F^{−1}(u) = inf\{x∈ℝ : F(x) ≥ u\}$ with $(0 < u < 1)$ 

By using the property of the inverse distribution function: If $U$ is proportional to $Uniform[0,1]$ distribution, then $F^{−1}(U)$ has $F$ as its CDF, because by applying F to both sides $P(F^{−1}(U) ≤ x) = F(x)$, because $P(U ≤ y) = y$ when $U$ is in a $Uniform[0,1]$ distribution and $P(F^{−1}(U)≤ x) = P( F( F^{-1}(U) ) ≤ F(x) ) = P(U ≤ F(x))$.

Thus $F^{−1}$ will also follow the $Uniform[0,1]$ distribution.


(b) Propose an algorithm to sample from the Exponential distribution $Exp(λ)$ using a sample from the uniform distribution $U(0,1)$.

There are different approaches to sample an Exponential distribution from a $Uniform[0,1]$ distribution 
1. A sample of size n can be drawn from $Uniform[0,1]$ using runif in R
2. Using the result of (a) and a sample as argument for the inverse distribution function of the Exponential distribution. 

When $F_Y(y)$ is the cumulative distribution function of the exponential distribution, we have by definition $F_Y(y)=1-exp(-\lambda y)$ if $y≥0$. One can find $F_Y^{-1}(U)=\frac{-1}{\lambda ln(1-U)}$

Assume $Y$ is an exponential random variable with rate parameter $λ = 5$. The probability density


(c) Implement this algorithm in R, and use it to generate a 1000 -sample distributed according to $Exp(λ)$. Compare the distribution of the sample to $Exp(λ)$ using a graph.

```{r}
lambda <- 3
uniform_sample <- 1000
U <- runif(uniform_sample, min = 0, max = 1)
X <- -log(1-U)/lambda
hist(X, freq=F, xlab="X", main="Distribution using the inverse function")
hist(rexp(uniform_sample,lambda), freq=F, xlab = "Cauchy Distribution", main="Distribution using the inverse function")
curve(dexp(x, rate=lambda) , 0, 3, lwd=1, add = T)
qqplot(qexp(seq(0,1,0.1),lambda),X, xlab="Theoretical Quantiles", ylab="Observed Quantiles", type="o")
abline(0,1, col="red")
```

(d) Propose an algorithm to sample from a Cauchy distribution using a sample of the uniform distribution $U(0, 1)$. The density function of a Cauchy distribution with parameters $x_0 ∈ R$ and $γ > 0$ is: $f(x) = \frac{γ^2}{πγ(x − x_0)^2 +π γ^3}$

```{r}
set.seed(120)
uniform_sample <- 1000
U <- runif(uniform_sample, min = -pi/2, max = pi/2)
X <- tan(pi*(U-1/2))
hist(X, freq=F, xlim = c(-120, 120), breaks = 20, xlab = "X", main="Distribution using the inverse function and Generating Cauchy")
qqplot(qcauchy(seq(0,1,0.1),lambda),X, xlab="Theoretical Quantiles", ylab="Observed Quantiles", type="o")
abline(0,1, col="red")
```
## Exercise 4 - 

(c) Generalize this estimator to the case of n measurements x1, . . . , xn. Study the asymptotic properties of this estimator: is it strongly consistent? Asymptoti- cally normal? What is its asymptotic variance?

In the case of n measurements, the estimator is $\sum_{i=1}^n (\frac{d_i}{n})^2$

Using a regulation functional $T(\hat{F})= h(\mathbb{E}(D))= \sum_{i=1}^n (\frac{d_i}{n})^2$ and $D(x)$ and $h(x)$ being continuous and finite,  the Plug-in Estimator $T(\hat{F})$ converges asymptotically to $T(F)$ and the estimator is strongly consistent. 

As $h(x)$ and $\mathbb{E}(D(x))$ are continuous and differentiable in $\mathbb{E}(D(x))$, using the Delta Method theorem, it follows

$v(F) = h'(\mathbb{E}(D(X)))^2 \times Var(D(X))$, with $h'(\mathbb{E}(D(X)))=h'(µ)=2µ^2$ and $Var(D(X))=Var(X)=\sigma^2$

Thus it follows $v(F)=2µ^2\times\sigma^2$ and we come to the conclusion:

By the Delta method $\sqrt{n} \times (T(\hat{F})_{n}-T(F)) \xrightarrow{d} \mathcal{N}(0,v(F))$, the estimator is asymptotically normal with the asymptotic variance $v(F)=2µ^2*\sigma^2$.


## Exercise 5


(a) Load the dataset cider.csv in R.

```{r}
df1 <- read.csv(file="cider.csv", header = TRUE)
head(df1)
```

(b) Represent the distribution of ciders between brut, semi-dry and sweet using a barplot.
```{r}
library("ggplot2")
var1 <- ggplot(data=df1, aes(x = Type))
var1 + geom_bar(colour = "red", size = 1, alpha= 1, fill = "white") + theme(panel.grid.major = element_line(color="white", size =1), panel.grid.minor = element_blank()) + labs(title="Barplot of the distribution of cider flavors",
        x ="Cider flavors", y = "Frequency")
```

(c) Represent the distribution of the sweet flavor using a boxplot, for each type of cider.
```{r}
var2  <- ggplot(df1, aes(Type,Sweetness)) + geom_boxplot(color = "red", fill = "white")
var2 + ggtitle("Boxplot of the distribution of the sweet flavour")
```


(d) Represent the sweet flavor according to the bitter flavor and add the regres- sion line, for each type of cider. Hint: use the functions geom point and geom smooth.
```{r}
library(dplyr)

BitterSweet <- ggplot(df1, aes(x = Sweetness, y = Bitterness, color = Type)) + geom_point() + geom_smooth()
BitterSweet + ggtitle("Overview of the Sweetness according to the Bitterness for all Ciders")

dry <- select(filter(df1, Type == "Dry"), c(Sweetness, Acid, Bitterness, Astringent))
c_dry <-ggplot(dry, aes(x=Sweetness, y=Bitterness)) + geom_point(size= 2, shape=20, color="red", fill = "red") + geom_smooth(method = "lm", color="black", formula = y ~ x)
c_dry  + ggtitle("Representation of the Sweetness according to the Bitterness for Dry Ciders")

semi_dry <- select(filter(df1, Type == "Semi-dry"), c(Sweetness, Acid, Bitterness, Astringent))
c_semi_dry <-ggplot(semi_dry, aes(x=Sweetness, y=Bitterness)) + geom_point(size= 2, shape=20, color="green", fill = "green") + geom_smooth(method = "lm", color="black", formula = y ~ x)
c_semi_dry  + ggtitle("Representation of the Sweetness according to the Bitterness for Semi-dry Ciders")


sweet <- select(filter(df1, Type == "Sweet"), c(Sweetness, Acid, Bitterness, Astringent))
c_sweet<- ggplot(sweet, aes(x=Sweetness, y=Bitterness)) + geom_point(size= 2, shape=20, color="blue", fill = "blue") + geom_smooth(method = "lm", color="black", formula = y ~ x)
c_sweet + ggtitle("Representation of the Sweetness according to the Bitterness for Sweet Ciders")
```

